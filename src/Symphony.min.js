/*!
 * Copyright 2012 Nicolas Santangelo <nicosunshine@gmail.com>
 * Released under the MIT license
 */
(function(i,g){var c=i.Symphony=function(a){return this.setOptions(a||c.DEFAULTOPTIONS)};c.DEFAULTOPTIONS={template:"",elementName:"",replaceFunction:g,callback:g,generatedOutput:""};c.create=function(a){return new c(a)};c.prototype={setOptions:function(a){for(var e in a)a.hasOwnProperty(e)&&(this[e]=a[e]);return this},compose:function(a,e){var c="",l,j={find:function(a){var c=l,b="";c.nodeType?(b=c.getElementsByTagName(a)[0],""!==b&&(null!==b&&b!==g)&&(b=b.textContent||b.text||b.innerText)):b=c[a];
return b},change:function(a,e){var b=a,d=c;e!==g?("$"===b[0]&&(b=b.slice(1)),c=d.replace(RegExp("{\\/\\$"+b+"((\\?([\\w\\s\\'\\\"]+)})|})","g"),e)):c=d}},i=function(a,c){var b=a,d="",d="",d=a.slice(2).replace(c,"").replace("$",""),d=j.find(d);d!==g&&null!==d?d.slice&&""!==d?b=d:"function"===typeof d&&(b=d(j)):"}"!==c&&(b=c.slice(1,-1));return b};this.generatedOutput="";"function"!==typeof e?this.setOptions(e):this.callback=e;a=a||[{}];if(this.elementName&&a.nodeType){for(var f=a.getElementsByTagName(this.elementName),
h=[],k=0,m=f.length;k<m;k++)h.push(f[k]);a=h}else a.length||(a=[a]);f=0;for(h=a.length;f<h;f++)c=this.template,l=a[f],this.replaceFunction&&this.replaceFunction(j),this.generatedOutput+=c.replace(/\{\/\$?\w+((\?([\w\s\'\"]+)\})|\})/g,i);this.callback&&this.callback(this.generatedOutput);return this.generatedOutput}}})(window);